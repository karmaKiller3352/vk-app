(this["webpackJsonpreact-vk-app"]=this["webpackJsonpreact-vk-app"]||[]).push([[0],{101:function(e,t,a){e.exports=a(215)},106:function(e,t,a){},107:function(e,t,a){},215:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(44),l=a.n(c),s=(a(106),a(12)),o=(a(107),a(6)),u=a(17),i=a(223),m=a(217),d=a(221);function E(){return r.a.createElement(i.a,{bg:"primary",expand:"lg",variant:"primary"},r.a.createElement(m.a,null,r.a.createElement(o.c,{className:"navbar-brand",to:"/vk-app/"},r.a.createElement("img",{alt:"logo",className:"img-thumbnail",src:"assets/img/logo.png",width:"40"})),r.a.createElement(i.a.Toggle,{"aria-controls":"basic-navbar-nav"}),r.a.createElement(i.a.Collapse,{id:"basic-navbar-nav"},r.a.createElement(d.a,{className:"w-100"},r.a.createElement(o.c,{className:"nav-link",to:"/vk-app/",exact:!0},"Home")))))}var p=a(14),f=a.n(p),h=a(63),b=a(25),v=a(220),g=a(218),y=a(96),x=a(219),k=r.a.createContext(),_=["HIDDEN","FEMALE","MALE"];function O(){var e=Object(n.useContext)(k),t=e.state,a=e.dispatch;return 0!==t.length&&r.a.createElement(n.Fragment,null,r.a.createElement(g.a,{className:"mb-4"},r.a.createElement(y.a,null,r.a.createElement("h2",null,"Added Users"))),t.map((function(e){return r.a.createElement(g.a,{className:e.showFriends?"choosed user":"user",key:e.id},r.a.createElement(y.a,{md:2},r.a.createElement("img",{src:e.photo_100,alt:e.first_name})),r.a.createElement(y.a,{md:2},r.a.createElement("h3",null,e.first_name," ",e.last_name)),r.a.createElement(y.a,{md:3},r.a.createElement("p",null,r.a.createElement("b",null,"Date of Birth"),": ",e.bdate),r.a.createElement("p",null,r.a.createElement("b",null,"Gender"),": ",_[e.sex]),r.a.createElement("p",null,r.a.createElement("b",null,"Friends count"),": ",e.friendsCount||"Information closed"),r.a.createElement("p",null,r.a.createElement("b",null,"Profile"),": ",e.is_closed?"Closed":"Opened")),r.a.createElement(y.a,{md:2},r.a.createElement(v.a.Group,null,r.a.createElement(o.b,{className:"btn btn-primary",to:"/vk-app/user/".concat(e.id)},"\u041f\u0435\u0440\u0435\u0439\u0442\u0438")),r.a.createElement(v.a.Group,null,r.a.createElement(x.a,{type:"button",onClick:function(){a({type:"REMOVE_USER",payload:e.id})}},"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"))),r.a.createElement(y.a,{md:3},r.a.createElement(v.a.Group,null,r.a.createElement(x.a,{className:"btn btn-primary",onClick:function(){a({type:"CHECK_USER",payload:e.id})}},"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0434\u0440\u0443\u0437\u0435\u0439"))))})))}var j=a(27),w=a(97),N=a.n(w),C=a(98),F=a.n(C);function S(){var e=Object(n.useContext)(k).state.filter((function(e){return e.showFriends})),t=Object(j.a)(e.map((function(e){return e.friends})).flat());t.forEach((function(e){var a=0;t.forEach((function(t){t.id===Number(e.id)&&(a+=1),e.match="mutual-".concat(a)}))}));var a=N()(F()(t,"id"),["first_name","last_name"]);return r.a.createElement(n.Fragment,null,r.a.createElement(g.a,{className:"mb-4"},r.a.createElement("h2",null,"Friend list")),a.map((function(e){var t=e.first_name,a=e.last_name,n=e.photo_50,c=e.id,l=e.match;return r.a.createElement(g.a,{key:c,className:l},r.a.createElement(y.a,{md:3},r.a.createElement(o.b,{to:"/vk-app/user/".concat(c)},r.a.createElement("img",{src:n,alt:t}))),r.a.createElement(y.a,{md:8},r.a.createElement(o.b,{to:"/vk-app/user/".concat(c)},t," ",a)))})))}var U=a(23),I=a.n(U);function R(){var e=Object(n.useContext)(k),t=e.state,a=e.dispatch,c=e.requests,l=Object(n.useState)(""),o=Object(s.a)(l,2),u=o[0],i=o[1],m=Object(n.useState)(""),d=Object(s.a)(m,2),E=d[0],p=d[1];return Object(n.useEffect)((function(){function e(){return(e=Object(b.a)(f.a.mark((function e(t,n){var r,l,s,o,u,i,m,d,E,p,b;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I()(c.userInfo(t));case 2:return r=e.sent,l=r.json,e.next=6,l();case 6:if(s=e.sent,o=s.response){e.next=11;break}return console.log("User with this id does not exist"),e.abrupt("return",!1);case 11:if(o[0]){e.next=13;break}return e.abrupt("return",!1);case 13:if(u=o[0],!n.every((function(e){return e.id!==u.id}))){e.next=29;break}return e.next=18,I()(c.getUserFriends(u.id));case 18:return i=e.sent,e.next=21,i.json();case 21:m=e.sent,d=m.response?m.response.items:[],E=d.filter((function(e){return!e.deactivated}))||[],p=E.length,b=Object(h.a)(Object(h.a)({},u),{},{friendsCount:p,friends:E,showFriends:!1}),a({type:"ADD_USER",payload:b}),e.next=30;break;case 29:console.log("This user is already on the list");case 30:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return function(t,a){e.apply(this,arguments)}(E,t),function(){return p("")}}),[t,a,c,E]),Object(n.useEffect)((function(){document.title="React VK App"})),Object(n.useEffect)((function(){localStorage.setItem("users",JSON.stringify(t))}),[t]),r.a.createElement(n.Fragment,null,r.a.createElement(v.a,{onSubmit:function(e){e.preventDefault(),p(u),i("")}},r.a.createElement(g.a,null,r.a.createElement(y.a,{md:9},r.a.createElement(v.a.Group,null,r.a.createElement(v.a.Control,{required:!0,size:"lg",type:"text",placeholder:"user id",onChange:function(e){var t=e.target.value;i(t)},value:u}),r.a.createElement(v.a.Text,{className:"text-muted"},"Enter user id"))),r.a.createElement(y.a,{md:3},r.a.createElement(v.a.Group,{align:"right"},r.a.createElement(x.a,{className:"w-100",size:"lg",variant:"primary",type:"submit"},"Submit"))))),r.a.createElement(g.a,null,r.a.createElement(y.a,null,r.a.createElement("hr",null))),r.a.createElement(g.a,{className:"userlist"},r.a.createElement(y.a,{md:9},r.a.createElement(O,null)),r.a.createElement(y.a,{md:3,className:"all-friend-list"},r.a.createElement(S,null))))}var D=a(222);var A=function(e){var t=e.data,a=t.filter((function(e){return"photo"===e.type})),c=t.filter((function(e){return"video"===e.type})),l=t.filter((function(e){return"audio"===e.type}));return r.a.createElement(n.Fragment,null,a.length>0?r.a.createElement(D.a,null,a.map((function(e){var t=e.photo,a=t.sizes,n=t.text,c=t.id;return r.a.createElement(D.a.Item,{key:c},r.a.createElement("img",{className:"d-block w-100",src:a[4].url,alt:"First slide"}),r.a.createElement(D.a.Caption,null,r.a.createElement("p",null,n)))}))):null,c.length>0||l.length>0?r.a.createElement("i",null,"Post contains audio or video. Use official VK APP"):null)};function G(e){var t=e.data,a=e.id,c=Object(n.useContext)(k).requests,l=Object(n.useState)(null),o=Object(s.a)(l,2),u=o[0],i=o[1];return Object(n.useEffect)((function(){function e(){return(e=Object(b.a)(f.a.mark((function e(){var t,n,r,l;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I()(c.userInfo(a));case 2:return t=e.sent,n=t.json,e.next=6,n();case 6:if(r=e.sent,l=r.response){e.next=11;break}return console.log("User with this id does not exist"),e.abrupt("return",!1);case 11:console.log(l[0]),i(l[0]);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[a,c]),Object(n.useEffect)((function(){u&&(document.title="".concat(u.first_name," ").concat(u.last_name,"'s Wall"))})),!!t&&(0===t.length?r.a.createElement("h2",null,"This user hid his wall from accessing from outside"):t.map((function(e){return r.a.createElement("div",{className:"wall-post",key:e.id},r.a.createElement(g.a,{className:"post-header"},r.a.createElement(y.a,{md:2},r.a.createElement("img",{src:u.photo_100,alt:"",className:"profile-picture"})),r.a.createElement(y.a,{md:6},r.a.createElement("h5",null,u.first_name," ",u.last_name),r.a.createElement("h6",{className:"date"},new Date(1e3*e.date).toLocaleString()))),r.a.createElement(g.a,{className:"post-body"},r.a.createElement(y.a,{md:12},e.copy_history?r.a.createElement(r.a.Fragment,null,e.copy_history[0].attachments?r.a.createElement(A,{data:e.copy_history[0].attachments}):null,r.a.createElement("p",null,e.copy_history[0].text?e.copy_history[0].text:null)):null),r.a.createElement(y.a,{md:12},e.attachments?r.a.createElement(A,{data:e.attachments}):null,r.a.createElement("p",null,e.text))))})))}var T=function(e){var t=e.friends;return r.a.createElement(n.Fragment,null,t.map((function(e){var t=e.first_name,a=e.last_name,n=e.photo_100,c=e.id;return r.a.createElement(g.a,{key:c},r.a.createElement(y.a,{md:3},r.a.createElement(o.b,{to:"/vk-app/user/".concat(c)},r.a.createElement("img",{src:n,alt:t}))),r.a.createElement(y.a,{md:8},r.a.createElement(o.b,{to:"/vk-app/user/".concat(c)},t," ",a)))})))};function q(){var e=Object(n.useContext)(k),t=e.state,a=e.requests,c=Object(n.useState)(null),l=Object(s.a)(c,2),o=l[0],i=l[1],m=Object(u.f)().id;Object(n.useEffect)((function(){(function(){var e=Object(b.a)(f.a.mark((function e(t){var n,r,c,l,s;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",!1);case 2:return e.next=4,I()(a.userWall(t));case 4:return n=e.sent,r=n.json,e.t0=console,e.next=9,r();case 9:return e.t1=e.sent,e.t0.log.call(e.t0,e.t1),e.next=13,r();case 13:c=e.sent,l=c.response,s=c.error,null,s?(console.log(s.error_msg),i([])):i(Object(j.a)(l.items));case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}})()(m)}),[m,a]);var d=t.filter((function(e){return e.friends.find((function(e){return e.id===Number(m)}))}));return m?r.a.createElement(n.Fragment,null,r.a.createElement(g.a,null,r.a.createElement(y.a,{md:9},r.a.createElement("h2",null,"User wall"),r.a.createElement("hr",null)),r.a.createElement(y.a,{md:3},r.a.createElement("h2",null,"Friends with"),r.a.createElement("hr",null))),r.a.createElement(g.a,{className:"userlist"},r.a.createElement(y.a,{md:9,className:"wall"},r.a.createElement(G,{data:o,id:m})),r.a.createElement(y.a,{md:3,className:"friends-list"},r.a.createElement(T,{friends:d})))):r.a.createElement("h2",null,"This user doesnot exist")}var K=a(49),P=a(64),W=a.n(P),H=function(e,t){switch(t.type){case"REMOVE_USER":return e.filter((function(e){return e.id!==t.payload}));case"ADD_USER":return[t.payload].concat(Object(j.a)(e));case"CHECK_USER":var a=e.find((function(e){return e.id===t.payload})),n=a.showFriends,r=e.findIndex((function(e){return e.id===t.payload})),c=W()(a,{showFriends:{$set:!n}});return W()(e,Object(K.a)({},r,{$set:c}));default:return e}},J=localStorage.getItem("users")||"[]",M=JSON.parse(J),V="4b7861134b7861134b786113794b09feea44b784b78611315d6ecd19751dc711d47446d",z={userInfo:function(e){return"https://api.vk.com/method/users.get?&user_ids=".concat(e,"&fields=photo_100,bdate,sex&access_token=").concat(V,"&v=5.89")},userWall:function(e){return"https://api.vk.com/method/wall.get?&owner_id=".concat(e,"&access_token=").concat(V,"&v=5.103")},getUserFriends:function(e){return"https://api.vk.com/method/friends.get?&user_id=".concat(e,"&order=name&fields=photo_50&access_token=").concat(V,"&v=5.89")}};var B=function(){var e=Object(n.useReducer)(H,M),t=Object(s.a)(e,2),a=t[0],c=t[1];return r.a.createElement(k.Provider,{value:{state:a,dispatch:c,ACCESS_TOKEN:V,requests:z}},r.a.createElement(o.a,null,r.a.createElement(E,null),r.a.createElement("div",{className:"container pt-4"},r.a.createElement(u.c,null,r.a.createElement(u.a,{path:"/vk-app/",exact:!0,component:R}),r.a.createElement(u.a,{path:"/vk-app/user/:id",component:q})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(B,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[101,1,2]]]);
//# sourceMappingURL=main.0786a8ae.chunk.js.map